{% extends "layout.njk" %}
{% block css %}
<link href="https://unpkg.com/tabulator-tables@5.4.3/dist/css/tabulator.min.css" rel="stylesheet">

<style>
  /* Table background for dark theme */
.tabulator {
    background-color: #2c2c2c;
    color: #f5f5f5;
    border: 1px solid transparent;
}

/* Table header for dark theme */
.tabulator .tabulator-header {
    background-color: #0f111a ;
    background: #0f111a ;
    color: #f5f5f5;
    border-bottom: 1px solid #0f111a;
}

.tabulator .tabulator-header .tabulator-col {
  background-color: #0f111a ;
    background: #0f111a ;
}

/* Table rows for dark theme */
.tabulator .tabulator-row {
    background-color: #141824;
    color: #f5f5f5;
}

.tabulator .tabulator-row:nth-child(even) {
    background-color: #191e2d;
}

/* Row hover effect */
.tabulator .tabulator-row:hover {
    background-color: #1d2233;
}

/* Pagination buttons for dark theme */
.tabulator .tabulator-paginator button {
    background-color: #0f111a;
    color: #fff;
    border: none;
}

.tabulator .tabulator-footer .tabulator-page {
    background-color: #0f111a;
    color: #f5f5f5;
}

.tabulator .tabulator-paginator button:hover {
    background-color: #1d2233;
}

.tabulator .tabulator-footer {
    background-color: #0f111a;
    color: #f5f5f5;
    border-top: 1px solid #0f111a;
}

.toast-header {
    background-color: transparent;
    color: #f5f5f5;
}

</style>
{% endblock %}

{% block content %}
<div class="mx-n4 px-4 mx-lg-n6 px-lg-6 bg-white pt-7 border-y border-300">
  <div data-list='{"valueNames":["product","customer","rating","review","time"],"page":6}'>
    <div class="row align-items-end justify-content-between pb-5 g-3">
      <div class="col-auto">
        <h3>All Slash Commands</h3>
        <p class="text-700 lh-sm mb-0">List of all discord slash commands</p>
      </div>
    </div>
    <div class="search-box mb-3 mx-auto">
      <input class="form-control search-input form-control-sm" type="search" id="searchInput" placeholder="Search" aria-label="Search">
    </div>
    <div id="stash-table"></div>
  </div>
</div>

<footer class="footer position-absolute">
  <div class="row g-0 justify-content-between align-items-center h-100">
    <div class="col-12 col-sm-auto text-center">
      <p class="mb-0 mt-2 mt-sm-0 text-900">IsekaiExpress Bot made for F95Zone by Ryahn</p>
    </div>
    <div class="col-12 col-sm-auto text-center">
      <p class="mb-0 text-600">v1.13.0</p>
    </div>
  </div>
</footer>
<!-- Toast -->
<div class="position-fixed top-0 end-0 p-3" style="z-index: 11; top: 65px !important;">
  <div class="toast" id="myToast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="3000">
    <div class="toast-header">
      <strong class="me-auto">Message</strong>
      <small class="text-muted" id="timestamp"></small>
      <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
    <div class="toast-body">
      This is the body of the toast.
    </div>
  </div>
</div>
<!-- End of Toast -->
{% endblock %}

{% block scripts %}
<script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.4.3/dist/js/tabulator.min.js"></script>

<script>
		document.querySelector('.logout-link').addEventListener('click', function (e) {
    e.preventDefault();  // Prevent default link behavior
    document.getElementById('logout-form').submit();  // Submit the logout form
});
document.addEventListener("DOMContentLoaded", function() {
    var table = new Tabulator("#stash-table", {
        ajaxURL: "/commands/slashes/list", // Load data via AJAX
        ajaxResponse: function(url, params, response) {
            return response.commands; // Return the array from the response object
        },
        pagination: "local", // Enable pagination
        paginationSize: 10, // Set page size
        layout: "fitColumns", // Fit columns to width of table
        columns: [
			{ title: "Name", field: "name" },
			{ title: "description", field: "description" },
		]
    });


    // Search functionality
    document.getElementById("searchInput").addEventListener("input", function(event) {
		var searchValue = event.target.value.toLowerCase();

		table.setFilter(function(data, filterParams){
			// Safely check if each field is a string, otherwise, return false
			return (typeof data.name === 'string' && data.name.toLowerCase().includes(searchValue)) || 
				(typeof data.description === 'string' && data.description.toLowerCase().includes(searchValue));
		});
	});

});


	</script>
{% endblock %}